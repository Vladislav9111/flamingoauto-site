<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />
  <title>Content Manager</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <style>
    .logout-btn {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #dc3545;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      z-index: 10000;
      font-size: 14px;
    }
    .logout-btn:hover {
      background: #c82333;
    }
  </style>
</head>
<body>
  <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ -->
  <button id="logout-btn" class="logout-btn" onclick="logoutUser()">üö™ –í—ã–π—Ç–∏</button>
  
  <div id="nc-root"></div>
  <script src="https://unpkg.com/netlify-cms@^2.10.0/dist/netlify-cms.js"></script>
  <script>
    console.log('üöÄ –ó–∞–≥—Ä—É–∂–∞–µ–º CMS...');
    
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        console.log('Identity –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', user ? user.email : '–Ω–µ—Ç');
        
        if (!user) {
          console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞');
          window.netlifyIdentity.on("login", () => {
            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ—à–µ–ª, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É');
            document.location.href = "/admin/";
          });
        } else {
          console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω:', user.email);
          console.log('–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', user.app_metadata?.roles || '–Ω–µ—Ç —Ä–æ–ª–µ–π');
        }
      });
      
      window.netlifyIdentity.on("logout", () => {
        console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã—à–µ–ª');
        document.location.href = "/";
      });
      
      window.netlifyIdentity.init();
    } else {
      console.error('Netlify Identity –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É CMS
    setTimeout(() => {
      if (window.CMS) {
        console.log('‚úÖ CMS –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
      } else {
        console.error('‚ùå CMS –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
      }
    }, 3000);
    
    // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
    function logoutUser() {
      if (window.netlifyIdentity) {
        console.log('–í—ã—Ö–æ–¥–∏–º –∏–∑ —Å–∏—Å—Ç–µ–º—ã...');
        window.netlifyIdentity.logout();
      } else {
        alert('Netlify Identity –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
      }
    }
    
    // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ–π
    window.logoutUser = logoutUser;
  </script>
</body>
</html>