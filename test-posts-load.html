<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤ - Flamingo Auto</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-panel {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .test-result {
            background: #f8f9fa;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .post-item {
            background: #e9ecef;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 6px;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        .btn:hover { background: #0056b3; }
        .btn-success { background: #28a745; }
        .btn-success:hover { background: #218838; }
    </style>
</head>
<body>
    <main class="container test-panel">
        <div class="hero-header">
            <a class="logo" href="index.html">FLAMINGO AUTO</a>
        </div>

        <h1>üß™ –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å—Ç–æ–≤</h1>
        <p style="color: #666; margin-bottom: 2rem;">–ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—á–µ–º—É –ø–æ—Å—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –±–ª–æ–≥–µ</p>

        <div style="margin-bottom: 2rem;">
            <button class="btn" onclick="testNetlifyFunction()">üîß –¢–µ—Å—Ç Netlify Function</button>
            <button class="btn" onclick="testGitHubAPI()">üêô –¢–µ—Å—Ç GitHub API</button>
            <button class="btn btn-success" onclick="testBlogSystem()">üìù –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –±–ª–æ–≥–∞</button>
        </div>

        <div id="results"></div>

        <div style="margin-top: 2rem;">
            <a href="/blog.html" class="btn">üëÄ –û—Ç–∫—Ä—ã—Ç—å –±–ª–æ–≥</a>
            <a href="/admin/" class="btn">üîß –û—Ç–∫—Ä—ã—Ç—å CMS</a>
        </div>
    </main>

    <script>
        function showResult(title, content, type = 'info') {
            const results = document.getElementById('results');
            const color = type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#007bff';
            
            results.innerHTML += `
                <div class="test-result" style="border-left-color: ${color};">
                    <h3>${title}</h3>
                    <div>${content}</div>
                </div>
            `;
        }

        async function testNetlifyFunction() {
            showResult('üîß –¢–µ—Å—Ç–∏—Ä—É–µ–º Netlify Function', '–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã —á–µ—Ä–µ–∑ /.netlify/functions/get-posts-simple...');
            
            try {
                const response = await fetch('/.netlify/functions/get-posts-simple');
                const posts = await response.json();
                
                if (response.ok && posts.length > 0) {
                    const postsHtml = posts.map(post => `
                        <div class="post-item">
                            <strong>${post.title}</strong><br>
                            <small>–ê–≤—Ç–æ—Ä: ${post.author} | –î–∞—Ç–∞: ${new Date(post.date).toLocaleDateString()} | –Ø–∑—ã–∫: ${post.locale}</small><br>
                            <em>–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: ${post.published ? '–î–∞' : '–ù–µ—Ç'}</em>
                        </div>
                    `).join('');
                    
                    showResult('‚úÖ Netlify Function —Ä–∞–±–æ—Ç–∞–µ—Ç!', 
                        `–ù–∞–π–¥–µ–Ω–æ –ø–æ—Å—Ç–æ–≤: ${posts.length}<br>${postsHtml}`, 'success');
                } else {
                    showResult('‚ùå Netlify Function –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', 
                        `–°—Ç–∞—Ç—É—Å: ${response.status}<br>–ü–æ—Å—Ç–æ–≤: ${posts.length}<br>–û—Ç–≤–µ—Ç: ${JSON.stringify(posts)}`, 'error');
                }
            } catch (error) {
                showResult('‚ùå –û—à–∏–±–∫–∞ Netlify Function', 
                    `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function testGitHubAPI() {
            showResult('üêô –¢–µ—Å—Ç–∏—Ä—É–µ–º GitHub API', '–ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å—Ç—ã –Ω–∞–ø—Ä—è–º—É—é –∏–∑ GitHub...');
            
            try {
                const response = await fetch('https://api.github.com/repos/Vladislav9111/flamingoauto-site/contents/content/blog');
                const files = await response.json();
                
                if (response.ok) {
                    const mdFiles = files.filter(file => file.name.endsWith('.md'));
                    const filesHtml = mdFiles.slice(0, 5).map(file => `
                        <div class="post-item">
                            <strong>${file.name}</strong><br>
                            <small>–†–∞–∑–º–µ—Ä: ${file.size} –±–∞–π—Ç | –û–±–Ω–æ–≤–ª–µ–Ω: ${file.sha.substring(0, 7)}</small>
                        </div>
                    `).join('');
                    
                    showResult('‚úÖ GitHub API —Ä–∞–±–æ—Ç–∞–µ—Ç!', 
                        `–ù–∞–π–¥–µ–Ω–æ .md —Ñ–∞–π–ª–æ–≤: ${mdFiles.length}<br>${filesHtml}${mdFiles.length > 5 ? '<br><em>...–∏ –µ—â–µ ' + (mdFiles.length - 5) + ' —Ñ–∞–π–ª–æ–≤</em>' : ''}`, 'success');
                } else {
                    showResult('‚ùå GitHub API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', 
                        `–°—Ç–∞—Ç—É—Å: ${response.status}<br>–û—Ç–≤–µ—Ç: ${JSON.stringify(files)}`, 'error');
                }
            } catch (error) {
                showResult('‚ùå –û—à–∏–±–∫–∞ GitHub API', 
                    `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        async function testBlogSystem() {
            showResult('üìù –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –±–ª–æ–≥–∞', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫ –±–ª–æ–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å—Ç—ã...');
            
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º blog-simple-clean.js –µ—Å–ª–∏ –æ–Ω –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
                if (!window.FlamingoBlogSimple) {
                    const script = document.createElement('script');
                    script.src = '/blog-simple-clean.js';
                    document.head.appendChild(script);
                    
                    await new Promise(resolve => {
                        script.onload = resolve;
                    });
                }
                
                if (window.FlamingoBlogSimple && window.FlamingoBlogSimple.getPosts) {
                    const posts = await window.FlamingoBlogSimple.getPosts();
                    
                    if (posts.length > 0) {
                        const postsHtml = posts.slice(0, 3).map(post => `
                            <div class="post-item">
                                <strong>${post.title}</strong><br>
                                <small>–ê–≤—Ç–æ—Ä: ${post.author} | –î–∞—Ç–∞: ${new Date(post.date).toLocaleDateString()}</small><br>
                                <em>${post.content.substring(0, 100)}...</em>
                            </div>
                        `).join('');
                        
                        showResult('‚úÖ –°–∏—Å—Ç–µ–º–∞ –±–ª–æ–≥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!', 
                            `–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ—Å—Ç–æ–≤: ${posts.length}<br>${postsHtml}`, 'success');
                    } else {
                        showResult('‚ùå –°–∏—Å—Ç–µ–º–∞ –±–ª–æ–≥–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—Å—Ç—ã', 
                            '–ü–æ—Å—Ç—ã –µ—Å—Ç—å –≤ GitHub, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –±–ª–æ–≥–∞ –∏—Ö –Ω–µ –≤–∏–¥–∏—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Netlify Functions.', 'error');
                    }
                } else {
                    showResult('‚ùå –°–∏—Å—Ç–µ–º–∞ –±–ª–æ–≥–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 
                        '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å blog-simple-clean.js', 'error');
                }
            } catch (error) {
                showResult('‚ùå –û—à–∏–±–∫–∞ —Å–∏—Å—Ç–µ–º—ã –±–ª–æ–≥–∞', 
                    `–û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            showResult('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É', '–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã...');
        });
    </script>
</body>
</html>